<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Flashcards</title>

<link rel="manifest" href="manifest.json">
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>

:root{--main:#6c63ff}

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
background:linear-gradient(160deg,#0f1222,#1c1f3a);
height:100vh;
display:flex;
justify-content:center;
align-items:center;
color:white;
}

.app{width:100%;max-width:420px;padding:20px}

input{width:100%;margin-bottom:10px}

.sheetBar{
display:flex;
gap:8px;
overflow-x:auto;
margin-bottom:10px;
}

.sheetBtn{
padding:8px 12px;
border-radius:12px;
background:#ffffff20;
border:none;
color:white;
font-size:13px;
}

.sheetBtn.active{background:var(--main)}

.card{
background:white;
border-radius:22px;
padding:25px;
text-align:center;
min-height:180px;
display:flex;
flex-direction:column;
justify-content:center;
box-shadow:0 15px 40px rgba(0,0,0,.4);
}

.word{font-size:30px;font-weight:600;color:var(--main)}
.translation{font-size:22px;margin-top:8px;color:#000}

.controls,.row{
display:grid;
grid-template-columns:repeat(3,1fr);
gap:10px;
margin-top:12px;
}

button{
border:none;
border-radius:14px;
padding:14px;
background:#ffffff20;
color:white;
font-size:18px;
}

.active{background:var(--main)!important}

.example{margin-top:10px;font-size:14px;opacity:.8;min-height:40px}
.counter{text-align:center;margin-top:6px;font-size:13px;opacity:.6}

.hidden{display:none}

</style>
</head>

<body>

<div class="app">

<input type="file" id="upload">

<div id="sheetBar" class="sheetBar"></div>

<div id="card" class="card">
<div id="english" class="word">Charge ton Excel</div>
<div id="french" class="translation hidden"></div>
</div>

<div class="controls">
<button onclick="prev()">â¬…</button>
<button onclick="speak()">ðŸ”Š</button>
<button onclick="next()">âž¡</button>
</div>

<div class="row">
<button id="randomBtn" onclick="toggleRandom()">ðŸ”€</button>
<button id="reverseBtn" onclick="toggleReverse()">ðŸ”„</button>
<button onclick="showExample()">ðŸ’¬</button>
</div>

<div id="example" class="example"></div>
<div id="counter" class="counter"></div>

</div>

<script>

let workbook,cards=[],i=0,random=false,reversed=false,front=true;

const english=document.getElementById("english");
const french=document.getElementById("french");
const example=document.getElementById("example");
const counter=document.getElementById("counter");
const randomBtn=document.getElementById("randomBtn");
const reverseBtn=document.getElementById("reverseBtn");
const sheetBar=document.getElementById("sheetBar");
const card=document.getElementById("card");

upload.onchange=e=>{
let r=new FileReader();
r.onload=e=>{
workbook=XLSX.read(new Uint8Array(e.target.result),{type:"array"});
renderSheets();
loadSheet(workbook.SheetNames[0]);
};
r.readAsArrayBuffer(upload.files[0]);
};

function renderSheets(){
sheetBar.innerHTML="";
workbook.SheetNames.forEach((n,k)=>{
let b=document.createElement("button");
b.className="sheetBtn"+(k==0?" active":"");
b.innerText=n;
b.onclick=()=>loadSheet(n);
sheetBar.appendChild(b);
});
}

function loadSheet(name){
document.querySelectorAll(".sheetBtn").forEach(b=>b.classList.toggle("active",b.innerText===name));
let rows=XLSX.utils.sheet_to_json(workbook.Sheets[name],{header:1});
cards=[];
rows.forEach(r=>{if(r[0]&&r[1])cards.push([r[0],r[1],r[2]||""]);});
